#
# This script is Copyright (C) 2004-2021 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This script is released under the Tenable Subscription License and
# may not be used from within scripts released under another license
# without authorization from Tenable, Inc.
#
# See the following licenses for details:
#
# http://static.tenable.com/prod_docs/Nessus_6_SLA_and_Subscription_Agreement.pdf
#
# @PROFESSIONALFEED@
#
# $Revision: 1.1 $
# $Date: 2021/06/17 $
#
# description : This .audit is designed against the CIS Benchmark for Cisco IOS 15 Benchmark v4.1.0
#
# NOTE        : Some queries in this .audit require site-specific data to be known to the query in order to function properly.  Please note the following
#               queries and edit their values accordingly.
#
#<ui_metadata>
#<display_name>CIS Cisco IOS 15 L2 v4.1.0</display_name>
#<spec>
#  <type>CIS</type>
#  <name>Cisco IOS 15 L2</name>
#  <version>4.1.0</version>
#  <link>https://workbench.cisecurity.org/files/3156</link>
#</spec>
#<labels>cisco,cis,ios</labels>
#<benchmark_refs>LEVEL,CSCv6,CSCv7,CIS_Recommendation</benchmark_refs>
#<variables>
#  <variable>
#    <name>NTP_KEY_ID</name>
#    <default>10</default>
#    <description>Authentication key ID for NTP servs</description>
#    <info>This key should be used to authenticate communications with the routers NTP servers</info>
#  </variable>
#  <variable>
#    <name>NTP_SERVER</name>
#    <default>192.168.0.1</default>
#    <description>NTP server IP address</description>
#    <info>Your organization's preferred NTP server</info>
#  </variable>
#  <variable>
#    <name>AG_INGRESS_ACL</name>
#    <default>3</default>
#    <description>AG ingress ACL ID</description>
#    <info>The number of the access control list on the perimeter router's external interface used to block internal source addresses.</info>
#  </variable>
#  <variable>
#    <name>INTERNAL_NETWORK</name>
#    <default>192\.168\.1\.0 0\.0\.0\.255</default>
#    <description>Internal IP address and netmask</description>
#    <info>Your organization's internal IP address range, defined by an IP address and network mask. This network is used in the TCP intercept ACL and in the AG ingress ACL to block spoofed addresses.</info>
#  </variable>
#  <variable>
#    <name>EXTERNAL_INTERFACE</name>
#    <default>FastEthernet0/1</default>
#    <description>External interface name</description>
#    <info>The external interface for your organization.</info>
#  </variable>
#  <variable>
#    <name>KEY_CHAIN_NAME</name>
#    <default>eigrp-keys</default>
#    <description>Keychain name</description>
#    <info>The keychain name for your organization's routing protocol.</info>
#  </variable>
#  <variable>
#    <name>INTERNAL_NETWORK_INGRESS_ACL</name>
#    <default>1</default>
#    <description>Internal Network ingress ACL ID</description>
#    <info>The number of the access control list used to allow internal source addresses to enter the external interface.</info>
#  </variable>
#  <variable>
#    <name>AS_NUMBER</name>
#    <default>100</default>
#    <description>AS Number</description>
#    <info>The Autonomous System number used by the router</info>
#  </variable>
#  <variable>
#    <name>OSPF_KEY_ID</name>
#    <default>1</default>
#    <description>OSPF Key ID</description>
#    <info>Your organization's OSPF key ID</info>
#  </variable>
#  <variable>
#    <name>RIP_KEY_CHAIN</name>
#    <default>rip-keys</default>
#    <description>RIPv2 keychain name</description>
#    <info>The keychain for your organization's RIPv2 authentication. Leave blank if this keychain type is not used.</info>
#    <optional />
#  </variable>
#  <variable>
#    <name>RIP_KEY_NUMBER</name>
#    <default>key_number</default>
#    <description>RIPv2 key number</description>
#    <info>The key number for your organization's RIPv2 authentication. Leave blank if this keychain type is not used.</info>
#    <optional />
#  </variable>
#</variables>
#</ui_metadata>

<check_type:"Cisco">

<if>
  <condition type:"AND">
    <item>
      type        : CONFIG_CHECK
      description : "Check if Cisco IOS 15 is installed"
      item        : "^version 15"
    </item>
  </condition>

  <then>
    <report type:"PASSED">
      description : "CIS_Cisco_IOS_15_v4.1.0_Level_2.audit for Cisco IOS 15 from CIS Cisco IOS 15 Benchmark v4.1.0"
      see_also    : "https://workbench.cisecurity.org/files/3156"
    </report>

#
## 1 Management Plane
#
#
## 1.1 Local Authentication, Authorization and Accounting (AAA) Rules
#

    <item>
      type        : CONFIG_CHECK
      description : "1.1.7 Set 'aaa accounting' to log all privileged use commands using 'commands 15'"
      info        : "Runs accounting for all commands at the specified privilege level.

Rationale:

Authentication, authorization and accounting (AAA) systems provide an authoritative source for managing and monitoring access for devices. Centralizing control improves consistency of access control, the services that may be accessed once authenticated and accountability by tracking services accessed. Additionally, centralizing access control simplifies and reduces administrative costs of account provisioning and de-provisioning, especially when managing a large number of devices. AAA Accounting provides a management and audit trail for user and administrative sessions through RADIUS or TACACS+.

Impact:

Enabling 'aaa accounting' for privileged commands records and sends activity to the accounting servers and enables organizations to monitor and analyze privileged activity."
      solution    : "Configure AAA accounting for commands.

hostname(config)#aaa accounting commands 15 {default | list-name | guarantee-first}
{start-stop | stop-only | none} {radius | group group-name}

Default Value:

AAA accounting is disabled.

Additional Information:

Valid privilege level entries are integers from 0 through 15."
      reference   : "800-171|3.3.1,800-53|AU-12(1),CIS_Recommendation|1.1.7,CSCv6|5,CSCv7|5,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ITSG-33|AU-12(1),LEVEL|2A,PCI-DSSv3.2|8.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4"
      see_also    : "https://workbench.cisecurity.org/files/3156"
      item        : "aaa accounting commands 15 [^ ]+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "1.1.8 Set 'aaa accounting connection'"
      info        : "Provides information about all outbound connections made from the network access server.

Rationale:

Authentication, authorization and accounting (AAA) systems provide an authoritative source for managing and monitoring access for devices. Centralizing control improves consistency of access control, the services that may be accessed once authenticated and accountability by tracking services accessed. Additionally, centralizing access control simplifies and reduces administrative costs of account provisioning and de-provisioning, especially when managing a large number of devices. AAA Accounting provides a management and audit trail for user and administrative sessions through RADIUS and TACACS+.

Impact:

Implementing aaa accounting connection creates accounting records about connections from the network access server. Organizations should regular monitor these connection records for exceptions, remediate issues, and report findings regularly."
      solution    : "Configure AAA accounting for connections.

hostname(config)#aaa accounting connection {default | list-name | guarantee-first}
{start-stop | stop-only | none} {radius | group group-name}



Default Value:

AAA accounting is not enabled."
      reference   : "800-171|3.3.1,800-53|AU-12(1),CIS_Recommendation|1.1.8,CSCv6|16.9,CSCv7|16.2,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ITSG-33|AU-12(1),LEVEL|2A,PCI-DSSv3.2|8.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4"
      see_also    : "https://workbench.cisecurity.org/files/3156"
      item        : "aaa accounting connection [^ ]+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "1.1.9 Set 'aaa accounting exec'"
      info        : "Runs accounting for the EXEC shell session.

Rationale:

Authentication, authorization and accounting (AAA) systems provide an authoritative source for managing and monitoring access for devices. Centralizing control improves consistency of access control, the services that may be accessed once authenticated and accountability by tracking services accessed. Additionally, centralizing access control simplifies and reduces administrative costs of account provisioning and de-provisioning, especially when managing a large number of devices. AAA Accounting provides a management and audit trail for user and administrative sessions through RADIUS and TACACS+.

Impact:

Enabling aaa accounting exec creates accounting records for the EXEC terminal sessions on the network access server. These records include start and stop times, usernames, and date information. Organizations should regularly monitor these records for exceptions, remediate issues, and report findings."
      solution    : "Configure AAA accounting for EXEC shell session.

hostname(config)#aaa accounting exec {default | list-name | guarantee-first}
{start-stop | stop-only | none} {radius | group group-name}

Default Value:

AAA accounting is not enabled."
      reference   : "800-171|3.3.1,800-53|AU-12(1),CIS_Recommendation|1.1.9,CSCv6|6,CSCv7|6,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ITSG-33|AU-12(1),LEVEL|2A,PCI-DSSv3.2|8.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4"
      see_also    : "https://workbench.cisecurity.org/files/3156"
      item        : "aaa accounting exec [^ ]+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "1.1.10 Set 'aaa accounting network'"
      info        : "Runs accounting for all network-related service requests.

Rationale:

Authentication, authorization and accounting (AAA) systems provide an authoritative source for managing and monitoring access for devices. Centralizing control improves consistency of access control, the services that may be accessed once authenticated and accountability by tracking services accessed. Additionally, centralizing access control simplifies and reduces administrative costs of account provisioning and de-provisioning, especially when managing a large number of devices. AAA Accounting provides a management and audit trail for user and administrative sessions through RADIUS and TACACS+.

Impact:

Implementing aaa accounting network creates accounting records for a method list including ARA, PPP, SLIP, and NCPs sessions. Organizations should regular monitor these records for exceptions, remediate issues, and report findings."
      solution    : "Configure AAA accounting for connections.

hostname(config)#aaa accounting network {default | list-name | guarantee-first}
{start-stop | stop-only | none} {radius | group group-name}

Default Value:

AAA accounting is not enabled."
      reference   : "800-171|3.3.1,800-53|AU-12(1),CIS_Recommendation|1.1.10,CSCv7|6,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ITSG-33|AU-12(1),LEVEL|2A,PCI-DSSv3.2|8.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4"
      see_also    : "https://workbench.cisecurity.org/files/3156"
      item        : "aaa accounting network [^ ]+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "1.1.11 Set 'aaa accounting system'"
      info        : "Performs accounting for all system-level events not associated with users, such as reloads.

Rationale:

Authentication, authorization and accounting (AAA) systems provide an authoritative source for managing and monitoring access for devices. Centralizing control improves consistency of access control, the services that may be accessed once authenticated and accountability by tracking services accessed. Additionally, centralizing access control simplifies and reduces administrative costs of account provisioning and de-provisioning, especially when managing a large number of devices. AAA Accounting provides a management and audit trail for user and administrative sessions through RADIUS and TACACS+.

Impact:

Enabling aaa accounting system creates accounting records for all system-level events. Organizations should regular monitor these records for exceptions, remediate issues, and report findings regularly."
      solution    : "Configure AAA accounting system.

hostname(config)#aaa accounting system {default | list-name | guarantee-first}
{start-stop | stop-only | none} {radius | group group-name}

Default Value:

AAA accounting is not enabled."
      reference   : "800-171|3.3.1,800-53|AU-12(1),CIS_Recommendation|1.1.11,CSCv6|6,CSCv7|6,CSF|DE.CM-1,CSF|DE.CM-3,CSF|DE.CM-7,CSF|PR.PT-1,ITSG-33|AU-12(1),LEVEL|2A,PCI-DSSv3.2|8.1,QCSC-v1|3.2,QCSC-v1|6.2,QCSC-v1|8.2.1,QCSC-v1|13.2,SWIFT-CSCv1|6.4"
      see_also    : "https://workbench.cisecurity.org/files/3156"
      item        : "aaa accounting system [^ ]+"
    </item>

#
## 1.2 Access Rules
#
# No applicable Level II Checks
#
## 1.3 Banner Rules
#
# No applicable Level II Checks
#
## 1.4 Password Rules
#
# No applicable Level II Checks
#
## 1.5 SNMP Rules
#

    <if>
      <condition type:"AND">
        <item>
          type        : CONFIG_CHECK
          description : "SNMP is enabled"
          item        : "snmp-server community .+"
        </item>
      </condition>

      <then>
        <item>
          type        : CONFIG_CHECK
          description : "1.5.9 Set 'priv' for each 'snmp-server group' using SNMPv3"
          info        : "Specifies authentication of a packet with encryption when using SNMPv3

Rationale:

SNMPv3 provides much improved security over previous versions by offering options for Authentication and Encryption of messages. When configuring a user for SNMPv3 you have the option of using a range of encryption schemes, or no encryption at all, to protect messages in transit. AES128 is the minimum strength encryption method that should be deployed.

Impact:

Organizations using SNMP can significantly reduce the risks of unauthorized access by using the 'snmp-server group v3 priv' setting to encrypt messages in transit."
          solution    : "For each SNMPv3 group created on your router add privacy options by issuing the following command...


hostname(config)#snmp-server group {<em>group_name</em>} v3 priv

Default Value:

No SNMP server groups are configured."
          reference   : "800-171|3.13.8,800-53|SC-8(1),CIS_Recommendation|1.5.9,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv6|3.4,CSCv7|4.5,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),LEVEL|2M,NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|7.1.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|2.1,TBA-FIISB|29.1"
          see_also    : "https://workbench.cisecurity.org/files/3156"
          regex       : "snmp-server group .+ v3 priv"
          item        : "snmp-server group .+ v3"
        </item>

        <item>
          type        : CONFIG_CHECK_NOT
          description : "1.5.10 Require 'aes 128' as minimum for 'snmp-server user' when using SNMPv3"
          info        : "Specify the use of a minimum of 128-bit AES algorithm for encryption when using SNMPv3.

Rationale:

SNMPv3 provides much improved security over previous versions by offering options for Authentication and Encryption of messages. When configuring a user for SNMPv3 you have the option of using a range of encryption schemes, or no encryption at all, to protect messages in transit. AES128 is the minimum strength encryption method that should be deployed.

Impact:

Organizations using SNMP can significantly reduce the risks of unauthorized access by using the 'snmp-server user' setting with appropriate authentication and privacy protocols to encrypt messages in transit."
          solution    : "For each SNMPv3 user created on your router add privacy options by issuing the following command.


hostname(config)#snmp-server user {user_name} {group_name} v3 auth sha {auth_password} priv aes 128 {priv_password} {acl_name_or_number}

Default Value:

SNMP username as not set by default."
          reference   : "800-171|3.13.11,800-53|SC-13.,CIS_Recommendation|1.5.10,CSCv6|3.4,CSCv7|4.5,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,LEVEL|2M,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2"
          see_also    : "https://workbench.cisecurity.org/files/3156"
          cmd         : "show snmp user"
          item        : "Privacy Protocol: (DES|3DES)"
        </item>
      </then>

      <else>
        <report type:"PASSED">
          description : "1.5.9 Set 'priv' for each 'snmp-server group' using SNMPv3"
          info        : "Specifies authentication of a packet with encryption when using SNMPv3

Rationale:

SNMPv3 provides much improved security over previous versions by offering options for Authentication and Encryption of messages. When configuring a user for SNMPv3 you have the option of using a range of encryption schemes, or no encryption at all, to protect messages in transit. AES128 is the minimum strength encryption method that should be deployed.

Impact:

Organizations using SNMP can significantly reduce the risks of unauthorized access by using the 'snmp-server group v3 priv' setting to encrypt messages in transit."
          solution    : "For each SNMPv3 group created on your router add privacy options by issuing the following command...


hostname(config)#snmp-server group {<em>group_name</em>} v3 priv

Default Value:

No SNMP server groups are configured."
          reference   : "800-171|3.13.8,800-53|SC-8(1),CIS_Recommendation|1.5.9,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv6|3.4,CSCv7|4.5,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),LEVEL|2M,NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|7.1.2,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|2.1,TBA-FIISB|29.1"
          see_also    : "https://workbench.cisecurity.org/files/3156"
        </report>

        <report type:"PASSED">
          description : "1.5.10 Require 'aes 128' as minimum for 'snmp-server user' when using SNMPv3"
          info        : "Specify the use of a minimum of 128-bit AES algorithm for encryption when using SNMPv3.

Rationale:

SNMPv3 provides much improved security over previous versions by offering options for Authentication and Encryption of messages. When configuring a user for SNMPv3 you have the option of using a range of encryption schemes, or no encryption at all, to protect messages in transit. AES128 is the minimum strength encryption method that should be deployed.

Impact:

Organizations using SNMP can significantly reduce the risks of unauthorized access by using the 'snmp-server user' setting with appropriate authentication and privacy protocols to encrypt messages in transit."
          solution    : "For each SNMPv3 user created on your router add privacy options by issuing the following command.


hostname(config)#snmp-server user {user_name} {group_name} v3 auth sha {auth_password} priv aes 128 {priv_password} {acl_name_or_number}

Default Value:

SNMP username as not set by default."
          reference   : "800-171|3.13.11,800-53|SC-13.,CIS_Recommendation|1.5.10,CSCv6|3.4,CSCv7|4.5,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ITSG-33|SC-13,ITSG-33|SC-13a.,LEVEL|2M,NESA|M5.2.6,NESA|T7.4.1,NIAv2|CY3,NIAv2|CY4,NIAv2|CY5b,NIAv2|CY5c,NIAv2|CY5d,NIAv2|CY7,NIAv2|NS5e,QCSC-v1|6.2"
          see_also    : "https://workbench.cisecurity.org/files/3156"
        </report>
      </else>
    </if>

#
## 2 Control Plane
#
#
## 2.1 Global Service Rules
#
# No applicable Level II Checks
#
## 2.2 Logging Rules
#
# No applicable Level II Checks
#
## 2.3 NTP Rules
#

    <item>
      type        : CONFIG_CHECK
      description : "2.3.1.1 Set 'ntp authenticate'"
      info        : "Enable NTP authentication.

Rationale:

Using authenticated NTP ensures the Cisco device only permits time updates from authorized NTP servers.

Impact:

Organizations should establish three Network Time Protocol (NTP) hosts to set consistent time across the enterprise. Enabling the 'ntp authenticate' command enforces authentication between NTP hosts."
      solution    : "Configure NTP authentication:


hostname(config)#ntp authenticate

Default Value:

NTP authentication is not enabled."
      reference   : "800-171|3.5.3,800-53|IA-2(1),CIS_Recommendation|2.3.1.1,CN-L3|7.1.2.7(b),CSCv6|6.1,CSCv7|6.1,CSF|PR.AC-1,ITSG-33|IA-2(1),LEVEL|2A,NESA|T5.4.2,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
      see_also    : "https://workbench.cisecurity.org/files/3156"
      item        : "[ ]*ntp authenticate"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "2.3.1.2 Set 'ntp authentication-key'"
      info        : "Define an authentication key for Network Time Protocol (NTP).

Rationale:

Using an authentication key provides a higher degree of security as only authenticated NTP servers will be able to update time for the Cisco device.

Impact:

Organizations should establish three Network Time Protocol (NTP) hosts to set consistent time across the enterprise. Enabling the 'ntp authentication-key' command enforces encrypted authentication between NTP hosts."
      solution    : "Configure at the NTP key ring and encryption key using the following command


hostname(config)#ntp authentication-key {ntp_key_id} md5 {ntp_key_hash}

Default Value:

No authentication key is defined for NTP."
      reference   : "800-171|3.5.3,800-53|IA-2(1),CIS_Recommendation|2.3.1.2,CN-L3|7.1.2.7(b),CSCv6|6.1,CSCv7|6.1,CSF|PR.AC-1,ITSG-33|IA-2(1),LEVEL|2A,NESA|T5.4.2,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
      see_also    : "https://workbench.cisecurity.org/files/3156"
# Note: Variable @NTP_KEY_ID@ replaced with "10" in field "regex".
      regex       : "[ ]*ntp authentication-key 10 md5"
      item        : "[ ]*ntp authentication-key .+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "2.3.1.3 Set the 'ntp trusted-key'"
      info        : "Ensure you authenticate the identity of a system to which Network Time Protocol (NTP) will synchronize

Rationale:

This authentication function provides protection against accidentally synchronizing the system to another system that is not trusted, because the other system must know the correct authentication key.

Impact:

Organizations should establish three Network Time Protocol (NTP) hosts to set consistent time across the enterprise. Enabling the 'ntp trusted-key' command enforces encrypted authentication between NTP hosts."
      solution    : "Configure the NTP trusted key using the following command


hostname(config)#ntp trusted-key {ntp_key_id}

Default Value:

Authentication of the identity of the system is disabled."
      reference   : "800-171|3.5.3,800-53|IA-2(1),CIS_Recommendation|2.3.1.3,CN-L3|7.1.2.7(b),CSCv6|6.1,CSCv7|6.1,CSF|PR.AC-1,ITSG-33|IA-2(1),LEVEL|2A,NESA|T5.4.2,NIAv2|AM36,NIAv2|VL3c,QCSC-v1|5.2.2,QCSC-v1|13.2,SWIFT-CSCv1|1.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
      see_also    : "https://workbench.cisecurity.org/files/3156"
# Note: Variable @NTP_KEY_ID@ replaced with "10" in field "regex".
      regex       : "[ ]*ntp trusted-key 10"
      item        : "[ ]*ntp trusted-key .+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "2.3.1.4 Set 'key' for each 'ntp server'"
      info        : "Specifies the authentication key for NTP.

Rationale:

This authentication feature provides protection against accidentally synchronizing the ntp system to another system that is not trusted, because the other system must know the correct authentication key.

Impact:

Organizations should establish three Network Time Protocol (NTP) hosts to set consistent time across the enterprise. Enabling the 'ntp server key' command enforces encrypted authentication between NTP hosts."
      solution    : "Configure each NTP Server to use a key ring using the following command.


hostname(config)#ntp server {<em>ntp-server_ip_address</em>}{key <em>ntp_key_id</em>}

Default Value:

No NTP key is set by default"
      reference   : "800-171|3.3.7,800-53|AU-8(1),800-53|AU-8(2),CIS_Recommendation|2.3.1.4,CN-L3|8.1.4.3(b),CSCv6|6.1,CSCv7|6.1,CSF|PR.PT-1,ISO/IEC-27001|A.12.4.4,ITSG-33|AU-8(1),LEVEL|2M,NESA|T3.6.7,NIAv2|NS44,NIAv2|NS45,NIAv2|NS46,NIAv2|NS47,QCSC-v1|8.2.1,QCSC-v1|13.2,TBA-FIISB|37.4"
      see_also    : "https://workbench.cisecurity.org/files/3156"
# Note: Variable @NTP_KEY_ID@ replaced with "10" in field "regex".
# Note: Variable @NTP_SERVER@ replaced with "192.168.0.1" in field "regex".
      regex       : "[ ]*ntp server 192.168.0.1 key 10"
      item        : "[ ]*ntp server .+ key .+"
    </item>

#
## 2.4 Loopback Rules
#

    <item>
      type            : CONFIG_CHECK
      description     : "2.4.1 Create a single 'interface loopback' - 'Only one loopback interface is defined'"
      info            : "Configure a single loopback interface.

Rationale:

Software-only loopback interface that emulates an interface that is always up. It is a virtual interface supported on all platforms.

Alternate loopback addresses create a potential for abuse, mis-configuration, and inconsistencies. Additional loopback interfaces must be documented and approved prior to use by local security personnel.

Impact:

Organizations should plan and establish 'loopback interfaces' for the enterprise network. Loopback interfaces enable critical network information such as OSPF Router IDs and provide termination points for routing protocol sessions."
      solution        : "Define and configure one loopback interface.


hostname(config)#interface loopback <<em>number</em>>
hostname(config-if)#ip address <<em>loopback_ip_address</em>> <<em>loopback_subnet_mask</em>>

Default Value:

There are no loopback interfaces defined by default."
      reference       : "800-171|3.4.2,800-53|CM-6b.,CIS_Recommendation|2.4.1,CN-L3|8.1.10.6(d),CSCv6|3.1,CSCv6|9.1,CSCv7|9.2,CSF|PR.IP-1,ITSG-33|CM-6b.,LEVEL|2A,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also        : "https://workbench.cisecurity.org/files/3156"
      item            : "interface [Ll]oopback"
      max_occurrences : "1"
    </item>

    <item>
      type            : CONFIG_CHECK
      description     : "2.4.1 Create a single 'interface loopback' - 'Only one loopback interface IP Address is defined'"
      info            : "Configure a single loopback interface.

Rationale:

Software-only loopback interface that emulates an interface that is always up. It is a virtual interface supported on all platforms.

Alternate loopback addresses create a potential for abuse, mis-configuration, and inconsistencies. Additional loopback interfaces must be documented and approved prior to use by local security personnel.

Impact:

Organizations should plan and establish 'loopback interfaces' for the enterprise network. Loopback interfaces enable critical network information such as OSPF Router IDs and provide termination points for routing protocol sessions."
      solution        : "Define and configure one loopback interface.


hostname(config)#interface loopback <<em>number</em>>
hostname(config-if)#ip address <<em>loopback_ip_address</em>> <<em>loopback_subnet_mask</em>>

Default Value:

There are no loopback interfaces defined by default."
      reference       : "800-171|3.4.2,800-53|CM-6b.,CIS_Recommendation|2.4.1,CN-L3|8.1.10.6(d),CSCv6|3.1,CSCv6|9.1,CSCv7|9.2,CSF|PR.IP-1,ITSG-33|CM-6b.,LEVEL|2A,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
      see_also        : "https://workbench.cisecurity.org/files/3156"
      context         : "interface [Ll]oopback"
      item            : "ip address"
      min_occurrences : "1"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "2.4.2 Set AAA 'source-interface'"
      info        : "Force AAA to use the IP address of a specified interface for all outgoing AAA packets

Rationale:

This is required so that the AAA server (RADIUS or TACACS+) can easily identify routers and authenticate requests by their IP address.

Impact:

Organizations should design and implement authentication, authorization, and accounting (AAA) services for effective monitoring of enterprise network devices. Binding AAA services to the source-interface loopback enables these services."
      solution    : "Bind AAA services to the loopback interface.


Hostname(config)#ip radius source-interface loopback {loopback_interface_number}
or
Hostname(config)#aaa group server tacacs+ {group_name} hostname(config-sg-tacacs+)#ip tacacs source-interface {loopback_interface_number}"
      reference   : "800-171|3.13.2,800-171|3.13.5,800-53|SC-7(13),CIS_Recommendation|2.4.2,CN-L3|8.1.10.6(h),CSCv6|16.9,CSCv7|16.2,CSF|PR.AC-5,CSF|PR.PT-4,ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(13),LEVEL|2A,NESA|T4.5.4,NIAv2|GS7d,PCI-DSSv3.2|2.2.4,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|3.1,TBA-FIISB|43.1"
      see_also    : "https://workbench.cisecurity.org/files/3156"
      item        : "ip (tacacs|radius) source-interface [Ll]oopback"
    </item>

    <if>
      <condition type:"OR">
        <item>
          type        : CONFIG_CHECK
          description : "2.4.3 Set 'ntp source' to Loopback Interface - 'NTP is bound to loopback'"
          item        : "[ ]*ntp source [Ll]oopback"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "2.4.3 Set 'ntp source' to Loopback Interface - 'SNTP is bound to loopback'"
          item        : "[ ]*sntp source-interface [Ll]oopback"
        </item>
      </condition>

      <then>
        <report type:"PASSED">
          description : "2.4.3 Set 'ntp source' to Loopback Interface - 'NTP/SNTP is bound to loopback'"
          info        : "Use a particular source address in Network Time Protocol (NTP) packets.

Rationale:

Set the source address to be used when sending NTP traffic. This may be required if the NTP servers you peer with filter based on IP address.

Impact:

Organizations should plan and implement network time protocol (NTP) services to establish official time for all enterprise network devices. Setting 'ntp source loopback' enforces the proper IP address for NTP services."
          solution    : "Bind the NTP service to the loopback interface.


hostname(config)#ntp source loopback {<em>loopback_interface_number}</em>

Default Value:

Source address is determined by the outgoing interface."
          reference   : "CSCv6|6.1,CSCv7|6.1,LEVEL|2A,CIS_Recommendation|2.4.3"
          see_also    : "https://workbench.cisecurity.org/files/3156"
        </report>
      </then>

      <else>
        <item>
          type        : CONFIG_CHECK
          description : "2.4.3 Set 'ntp source' to Loopback Interface - 'NTP is bound to loopback'"
          info        : "Use a particular source address in Network Time Protocol (NTP) packets.

Rationale:

Set the source address to be used when sending NTP traffic. This may be required if the NTP servers you peer with filter based on IP address.

Impact:

Organizations should plan and implement network time protocol (NTP) services to establish official time for all enterprise network devices. Setting 'ntp source loopback' enforces the proper IP address for NTP services."
          solution    : "Bind the NTP service to the loopback interface.


hostname(config)#ntp source loopback {<em>loopback_interface_number}</em>

Default Value:

Source address is determined by the outgoing interface."
          reference   : "800-171|3.4.2,800-53|CM-6b.,CIS_Recommendation|2.4.3,CN-L3|8.1.10.6(d),CSCv6|3.1,CSCv6|6.1,CSCv7|6.1,CSF|PR.IP-1,ITSG-33|CM-6b.,LEVEL|2A,NESA|T3.2.1,PCI-DSSv3.1|2.2.4,PCI-DSSv3.2|2.2.4,SWIFT-CSCv1|2.3"
          see_also    : "https://workbench.cisecurity.org/files/3156"
          item        : "[ ]*(ntp source|sntp source-interface) [Ll]oopback"
        </item>
      </else>
    </if>

    <item>
      type        : CONFIG_CHECK
      description : "2.4.4 Set 'ip tftp source-interface' to the Loopback Interface"
      info        : "Specify the IP address of an interface as the source address for TFTP connections.

Rationale:

This is required so that the TFTP servers can easily identify routers and authenticate requests by their IP address.

Impact:

Organizations should plan and implement trivial file transfer protocol (TFTP) services in the enterprise by setting 'tftp source-interface loopback', which enables the TFTP servers to identify routers and authenticate requests by IP address."
      solution    : "Bind the TFTP client to the loopback interface.


hostname(config)#ip tftp source-interface loopback {<em>loobpback_interface_number</em>}

Default Value:

The address of the closest interface to the destination is selected as the source address."
      reference   : "800-171|3.13.2,800-171|3.13.5,800-53|SC-7(13),CIS_Recommendation|2.4.4,CN-L3|8.1.10.6(h),CSCv6|9.1,CSCv7|9.2,CSF|PR.AC-5,CSF|PR.PT-4,ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(13),LEVEL|2A,NESA|T4.5.4,NIAv2|GS7d,PCI-DSSv3.2|2.2.4,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,SWIFT-CSCv1|3.1,TBA-FIISB|43.1"
      see_also    : "https://workbench.cisecurity.org/files/3156"
      item        : "ip tftp source-interface [Ll]oopback"
    </item>

#
## 3 Data Plane
#
#
## 3.1 Routing Rules
#

    <item>
      type        : CONFIG_CHECK
      description : "3.1.2 Set 'no ip proxy-arp'"
      info        : "Disable proxy ARP on all interfaces.

Rationale:

Address Resolution Protocol (ARP) provides resolution between IP and MAC Addresses (or other Network and Link Layer addresses on none IP networks) within a Layer 2 network.

Proxy ARP is a service where a device connected to one network (in this case the Cisco router) answers ARP Requests which are addressed to a host on another network, replying with its own MAC Address and forwarding the traffic on to the intended host.

Sometimes used for extending broadcast domains across WAN links, in most cases Proxy ARP on enterprise networks is used to enable communication for hosts with mis-configured subnet masks, a situation which should no longer be a common problem. Proxy ARP effectively breaks the LAN Security Perimeter, extending a network across multiple Layer 2 segments. Using Proxy ARP can also allow other security controls such as PVLAN to be bypassed.

Impact:

Organizations should plan and implement network policies to ensure unnecessary services are explicitly disabled. The 'ip proxy-arp' feature effectively breaks the LAN security perimeter and should be disabled."
      solution    : "Disable proxy ARP on all interfaces.


hostname(config)#interface {interface}
hostname(config-if)#no ip proxy-arp


Default Value:

Enabled"
      reference   : "800-171|3.13.1,800-53|SC-7(16),CIS_Recommendation|3.1.2,CN-L3|8.1.10.6(j),CSCv6|11,CSCv7|11,CSF|PR.PT-4,ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(16),LEVEL|2A,NESA|T4.5.4,NIAv2|GS8d,PCI-DSSv3.2|1.3.7,PCI-DSSv3.2|2.2.5,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1"
      see_also    : "https://workbench.cisecurity.org/files/3156"
      context     : "interface .+"
      item        : "no ip proxy-arp"
    </item>

    <item>
      type        : CONFIG_CHECK_NOT
      description : "3.1.3 Set 'no interface tunnel'"
      info        : "Verify no tunnel interfaces are defined.

Rationale:

Tunnel interfaces should not exist in general. They can be used for malicious purposes. If they are necessary, the network admin's should be well aware of them and their purpose.

Impact:

Organizations should plan and implement enterprise network security policies that disable insecure and unnecessary features that increase attack surfaces such as 'tunnel interfaces'."
      solution    : "Remove any tunnel interfaces.


hostname(config)#no interface tunnel {<em>instance</em>}

Default Value:

No tunnel interfaces are defined"
      reference   : "800-171|3.13.2,800-171|3.13.5,800-171|3.13.7,800-53|SC-7(7),CIS_Recommendation|3.1.3,CN-L3|8.1.10.6(j),CSCv6|11,CSCv7|11,CSF|PR.AC-5,CSF|PR.DS-5,CSF|PR.PT-4,ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(7),LEVEL|2A,NESA|T4.5.4,NIAv2|NS50,PCI-DSSv3.2|2.2.2,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1"
      see_also    : "https://workbench.cisecurity.org/files/3156"
      item        : "interface [Tt]unnel[0-9]+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "3.1.4 Set 'ip verify unicast source reachable-via'"
      info        : "Examines incoming packets to determine whether the source address is in the Forwarding Information Base (FIB) and permits the packet only if the source is reachable through the interface on which the packet was received (sometimes referred to as strict mode).

Rationale:

Enabled uRPF helps mitigate IP spoofing by ensuring only packet source IP addresses only originate from expected interfaces. Configure unicast reverse-path forwarding (uRPF) on all external or high risk interfaces.

Impact:

Organizations should plan and implement enterprise security policies that protect the confidentiality, integrity, and availability of network devices. The 'unicast Reverse-Path Forwarding' (uRPF) feature dynamically uses the router table to either accept or drop packets when arriving on an interface."
      solution    : "Configure uRPF.


hostname(config)#interface {<em>interface_name</em>}
hostname(config-if)#ip verify unicast source reachable-via rx

Default Value:

Unicast RPF is disabled."
      reference   : "800-171|3.13.1,800-53|SC-7(16),CIS_Recommendation|3.1.4,CN-L3|8.1.10.6(j),CSCv6|11,CSCv7|11,CSF|PR.PT-4,ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(16),LEVEL|2M,NESA|T4.5.4,NIAv2|GS8d,PCI-DSSv3.2|1.2.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|43.1"
      see_also    : "https://workbench.cisecurity.org/files/3156"
      context     : "interface .+"
      regex       : "ip verify unicast source reachable-via rx"
      item        : "ip verify unicast"
    </item>

#
## 3.2 Border Routing Filtering
#

    <item>
      type        : CONFIG_CHECK
      description : "3.2.1 Set 'ip access-list extended' to Forbid Private Source Addresses from External Networks - 'Deny internal networks'"
      info        : "This command places the router in access-list configuration mode, where you must define the denied or permitted access conditions by using the deny and permit commands.

Rationale:

Configuring access controls can help prevent spoofing attacks. To reduce the effectiveness of IP spoofing, configure access control to deny any traffic from the external network that has a source address that should reside on the internal network. Include local host address or any reserved private addresses (RFC 1918).

Ensure the permit rule(s) above the final deny rule only allow traffic according to your organization's least privilege policy.

Impact:

Organizations should plan and implement enterprise security policies that explicitly separate internal from external networks. Adding 'ip access-list' explicitly permitting and denying internal and external networks enforces these policies."
      solution    : "Configure ACL for private source address restrictions from external networks.


hostname(config)#ip access-list extended {<span><em>name | number</em>}
</span><span>hostname(config-nacl)#deny ip {</span><em>internal_networks</em>} any log
hostname(config<span>-nacl</span>)#deny ip 127.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 10.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 0.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 172.16.0.0 0.15.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.168.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.0.2.0 0.0.0.255 any log
hostname(config<span>-nacl</span>)#deny ip 169.254.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 224.0.0.0 31.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip host 255.255.255.255 any log
hostname(config<span>-nacl</span>)#permit {protocol} {source_ip} {source_mask} {destination} {destination_mask} log
hostname(config<span>-nacl</span>)#deny any any log
hostname(config)#interface <external_<em>interface</em>>
hostname(config-if)#access-group <<em>access-list</em>> in


Default Value:

No access list defined"
      reference   : "CIS_Recommendation|3.2.1,CSCv6|11,CSCv7|11,LEVEL|2M,PCI-DSSv3.2|1.2.1"
      see_also    : "https://workbench.cisecurity.org/files/3156"
# Note: Variable @AG_INGRESS_ACL@ replaced with "3" in field "context".
      context     : "ip access-list extended 3$"
# Note: Variable @INTERNAL_NETWORK@ replaced with "192\\.168\\.1\\.0 0\\.0\\.0\\.255" in field "regex".
      regex       : "deny +ip 192\\.168\\.1\\.0 0\\.0\\.0\\.255 any log"
# Note: Variable @INTERNAL_NETWORK@ replaced with "192\\.168\\.1\\.0 0\\.0\\.0\\.255" in field "item".
      item        : "deny +ip 192\\.168\\.1\\.0 0\\.0\\.0\\.255 .+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "3.2.1 Set 'ip access-list extended' to Forbid Private Source Addresses from External Networks - 'Deny 127.0.0.0'"
      info        : "This command places the router in access-list configuration mode, where you must define the denied or permitted access conditions by using the deny and permit commands.

Rationale:

Configuring access controls can help prevent spoofing attacks. To reduce the effectiveness of IP spoofing, configure access control to deny any traffic from the external network that has a source address that should reside on the internal network. Include local host address or any reserved private addresses (RFC 1918).

Ensure the permit rule(s) above the final deny rule only allow traffic according to your organization's least privilege policy.

Impact:

Organizations should plan and implement enterprise security policies that explicitly separate internal from external networks. Adding 'ip access-list' explicitly permitting and denying internal and external networks enforces these policies."
      solution    : "Configure ACL for private source address restrictions from external networks.


hostname(config)#ip access-list extended {<span><em>name | number</em>}
</span><span>hostname(config-nacl)#deny ip {</span><em>internal_networks</em>} any log
hostname(config<span>-nacl</span>)#deny ip 127.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 10.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 0.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 172.16.0.0 0.15.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.168.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.0.2.0 0.0.0.255 any log
hostname(config<span>-nacl</span>)#deny ip 169.254.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 224.0.0.0 31.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip host 255.255.255.255 any log
hostname(config<span>-nacl</span>)#permit {protocol} {source_ip} {source_mask} {destination} {destination_mask} log
hostname(config<span>-nacl</span>)#deny any any log
hostname(config)#interface <external_<em>interface</em>>
hostname(config-if)#access-group <<em>access-list</em>> in


Default Value:

No access list defined"
      reference   : "CIS_Recommendation|3.2.1,CSCv6|11,CSCv7|11,LEVEL|2M,PCI-DSSv3.2|1.2.1"
      see_also    : "https://workbench.cisecurity.org/files/3156"
# Note: Variable @AG_INGRESS_ACL@ replaced with "3" in field "context".
      context     : "ip access-list extended 3$"
      regex       : "deny +ip 127\\.0\\.0\\.0 0\\.255\\.255\\.255 any log"
      item        : "deny +ip 127\\.0\\.0\\.0 .+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "3.2.1 Set 'ip access-list extended' to Forbid Private Source Addresses from External Networks - 'Deny 10.0.0.0'"
      info        : "This command places the router in access-list configuration mode, where you must define the denied or permitted access conditions by using the deny and permit commands.

Rationale:

Configuring access controls can help prevent spoofing attacks. To reduce the effectiveness of IP spoofing, configure access control to deny any traffic from the external network that has a source address that should reside on the internal network. Include local host address or any reserved private addresses (RFC 1918).

Ensure the permit rule(s) above the final deny rule only allow traffic according to your organization's least privilege policy.

Impact:

Organizations should plan and implement enterprise security policies that explicitly separate internal from external networks. Adding 'ip access-list' explicitly permitting and denying internal and external networks enforces these policies."
      solution    : "Configure ACL for private source address restrictions from external networks.


hostname(config)#ip access-list extended {<span><em>name | number</em>}
</span><span>hostname(config-nacl)#deny ip {</span><em>internal_networks</em>} any log
hostname(config<span>-nacl</span>)#deny ip 127.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 10.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 0.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 172.16.0.0 0.15.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.168.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.0.2.0 0.0.0.255 any log
hostname(config<span>-nacl</span>)#deny ip 169.254.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 224.0.0.0 31.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip host 255.255.255.255 any log
hostname(config<span>-nacl</span>)#permit {protocol} {source_ip} {source_mask} {destination} {destination_mask} log
hostname(config<span>-nacl</span>)#deny any any log
hostname(config)#interface <external_<em>interface</em>>
hostname(config-if)#access-group <<em>access-list</em>> in


Default Value:

No access list defined"
      reference   : "CIS_Recommendation|3.2.1,CSCv6|11,CSCv7|11,LEVEL|2M,PCI-DSSv3.2|1.2.1"
      see_also    : "https://workbench.cisecurity.org/files/3156"
# Note: Variable @AG_INGRESS_ACL@ replaced with "3" in field "context".
      context     : "ip access-list extended 3$"
      regex       : "deny +ip 10\\.0\\.0\\.0 0\\.255\\.255\\.255 any log"
      item        : "deny +ip 10\\.0\\.0\\.0 .+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "3.2.1 Set 'ip access-list extended' to Forbid Private Source Addresses from External Networks - 'Deny 0.0.0.0'"
      info        : "This command places the router in access-list configuration mode, where you must define the denied or permitted access conditions by using the deny and permit commands.

Rationale:

Configuring access controls can help prevent spoofing attacks. To reduce the effectiveness of IP spoofing, configure access control to deny any traffic from the external network that has a source address that should reside on the internal network. Include local host address or any reserved private addresses (RFC 1918).

Ensure the permit rule(s) above the final deny rule only allow traffic according to your organization's least privilege policy.

Impact:

Organizations should plan and implement enterprise security policies that explicitly separate internal from external networks. Adding 'ip access-list' explicitly permitting and denying internal and external networks enforces these policies."
      solution    : "Configure ACL for private source address restrictions from external networks.


hostname(config)#ip access-list extended {<span><em>name | number</em>}
</span><span>hostname(config-nacl)#deny ip {</span><em>internal_networks</em>} any log
hostname(config<span>-nacl</span>)#deny ip 127.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 10.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 0.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 172.16.0.0 0.15.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.168.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.0.2.0 0.0.0.255 any log
hostname(config<span>-nacl</span>)#deny ip 169.254.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 224.0.0.0 31.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip host 255.255.255.255 any log
hostname(config<span>-nacl</span>)#permit {protocol} {source_ip} {source_mask} {destination} {destination_mask} log
hostname(config<span>-nacl</span>)#deny any any log
hostname(config)#interface <external_<em>interface</em>>
hostname(config-if)#access-group <<em>access-list</em>> in


Default Value:

No access list defined"
      reference   : "CIS_Recommendation|3.2.1,CSCv6|11,CSCv7|11,LEVEL|2M,PCI-DSSv3.2|1.2.1"
      see_also    : "https://workbench.cisecurity.org/files/3156"
# Note: Variable @AG_INGRESS_ACL@ replaced with "3" in field "context".
      context     : "ip access-list extended 3$"
      regex       : "deny +ip 0\\.0\\.0\\.0 0\\.255\\.255\\.255 any log"
      item        : "deny +ip 0\\.0\\.0\\.0 .+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "3.2.1 Set 'ip access-list extended' to Forbid Private Source Addresses from External Networks - 'Deny 172.16.0.0'"
      info        : "This command places the router in access-list configuration mode, where you must define the denied or permitted access conditions by using the deny and permit commands.

Rationale:

Configuring access controls can help prevent spoofing attacks. To reduce the effectiveness of IP spoofing, configure access control to deny any traffic from the external network that has a source address that should reside on the internal network. Include local host address or any reserved private addresses (RFC 1918).

Ensure the permit rule(s) above the final deny rule only allow traffic according to your organization's least privilege policy.

Impact:

Organizations should plan and implement enterprise security policies that explicitly separate internal from external networks. Adding 'ip access-list' explicitly permitting and denying internal and external networks enforces these policies."
      solution    : "Configure ACL for private source address restrictions from external networks.


hostname(config)#ip access-list extended {<span><em>name | number</em>}
</span><span>hostname(config-nacl)#deny ip {</span><em>internal_networks</em>} any log
hostname(config<span>-nacl</span>)#deny ip 127.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 10.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 0.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 172.16.0.0 0.15.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.168.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.0.2.0 0.0.0.255 any log
hostname(config<span>-nacl</span>)#deny ip 169.254.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 224.0.0.0 31.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip host 255.255.255.255 any log
hostname(config<span>-nacl</span>)#permit {protocol} {source_ip} {source_mask} {destination} {destination_mask} log
hostname(config<span>-nacl</span>)#deny any any log
hostname(config)#interface <external_<em>interface</em>>
hostname(config-if)#access-group <<em>access-list</em>> in


Default Value:

No access list defined"
      reference   : "CIS_Recommendation|3.2.1,CSCv6|11,CSCv7|11,LEVEL|2M,PCI-DSSv3.2|1.2.1"
      see_also    : "https://workbench.cisecurity.org/files/3156"
# Note: Variable @AG_INGRESS_ACL@ replaced with "3" in field "context".
      context     : "ip access-list extended 3$"
      regex       : "deny +ip 172\\.16\\.0\\.0 0\\.15\\.255\\.255 any log"
      item        : "deny +ip 172\\.16\\.0\\.0 .+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "3.2.1 Set 'ip access-list extended' to Forbid Private Source Addresses from External Networks - 'Deny 192.168.0.0'"
      info        : "This command places the router in access-list configuration mode, where you must define the denied or permitted access conditions by using the deny and permit commands.

Rationale:

Configuring access controls can help prevent spoofing attacks. To reduce the effectiveness of IP spoofing, configure access control to deny any traffic from the external network that has a source address that should reside on the internal network. Include local host address or any reserved private addresses (RFC 1918).

Ensure the permit rule(s) above the final deny rule only allow traffic according to your organization's least privilege policy.

Impact:

Organizations should plan and implement enterprise security policies that explicitly separate internal from external networks. Adding 'ip access-list' explicitly permitting and denying internal and external networks enforces these policies."
      solution    : "Configure ACL for private source address restrictions from external networks.


hostname(config)#ip access-list extended {<span><em>name | number</em>}
</span><span>hostname(config-nacl)#deny ip {</span><em>internal_networks</em>} any log
hostname(config<span>-nacl</span>)#deny ip 127.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 10.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 0.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 172.16.0.0 0.15.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.168.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.0.2.0 0.0.0.255 any log
hostname(config<span>-nacl</span>)#deny ip 169.254.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 224.0.0.0 31.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip host 255.255.255.255 any log
hostname(config<span>-nacl</span>)#permit {protocol} {source_ip} {source_mask} {destination} {destination_mask} log
hostname(config<span>-nacl</span>)#deny any any log
hostname(config)#interface <external_<em>interface</em>>
hostname(config-if)#access-group <<em>access-list</em>> in


Default Value:

No access list defined"
      reference   : "CIS_Recommendation|3.2.1,CSCv6|11,CSCv7|11,LEVEL|2M,PCI-DSSv3.2|1.2.1"
      see_also    : "https://workbench.cisecurity.org/files/3156"
# Note: Variable @AG_INGRESS_ACL@ replaced with "3" in field "context".
      context     : "ip access-list extended 3$"
      regex       : "deny +ip 192\\.168\\.0\\.0 0\\.0\\.255\\.255 any log"
      item        : "deny +ip 192\\.168\\.0\\.0 .+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "3.2.1 Set 'ip access-list extended' to Forbid Private Source Addresses from External Networks - 'Deny 192.0.2.0'"
      info        : "This command places the router in access-list configuration mode, where you must define the denied or permitted access conditions by using the deny and permit commands.

Rationale:

Configuring access controls can help prevent spoofing attacks. To reduce the effectiveness of IP spoofing, configure access control to deny any traffic from the external network that has a source address that should reside on the internal network. Include local host address or any reserved private addresses (RFC 1918).

Ensure the permit rule(s) above the final deny rule only allow traffic according to your organization's least privilege policy.

Impact:

Organizations should plan and implement enterprise security policies that explicitly separate internal from external networks. Adding 'ip access-list' explicitly permitting and denying internal and external networks enforces these policies."
      solution    : "Configure ACL for private source address restrictions from external networks.


hostname(config)#ip access-list extended {<span><em>name | number</em>}
</span><span>hostname(config-nacl)#deny ip {</span><em>internal_networks</em>} any log
hostname(config<span>-nacl</span>)#deny ip 127.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 10.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 0.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 172.16.0.0 0.15.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.168.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.0.2.0 0.0.0.255 any log
hostname(config<span>-nacl</span>)#deny ip 169.254.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 224.0.0.0 31.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip host 255.255.255.255 any log
hostname(config<span>-nacl</span>)#permit {protocol} {source_ip} {source_mask} {destination} {destination_mask} log
hostname(config<span>-nacl</span>)#deny any any log
hostname(config)#interface <external_<em>interface</em>>
hostname(config-if)#access-group <<em>access-list</em>> in


Default Value:

No access list defined"
      reference   : "CIS_Recommendation|3.2.1,CSCv6|11,CSCv7|11,LEVEL|2M,PCI-DSSv3.2|1.2.1"
      see_also    : "https://workbench.cisecurity.org/files/3156"
# Note: Variable @AG_INGRESS_ACL@ replaced with "3" in field "context".
      context     : "ip access-list extended 3$"
      regex       : "deny +ip 192\\.0\\.2\\.0 0\\.0\\.0\\.255 any log"
      item        : "deny +ip 192\\.0\\.2\\.0 .+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "3.2.1 Set 'ip access-list extended' to Forbid Private Source Addresses from External Networks - 'Deny 169.254.0.0'"
      info        : "This command places the router in access-list configuration mode, where you must define the denied or permitted access conditions by using the deny and permit commands.

Rationale:

Configuring access controls can help prevent spoofing attacks. To reduce the effectiveness of IP spoofing, configure access control to deny any traffic from the external network that has a source address that should reside on the internal network. Include local host address or any reserved private addresses (RFC 1918).

Ensure the permit rule(s) above the final deny rule only allow traffic according to your organization's least privilege policy.

Impact:

Organizations should plan and implement enterprise security policies that explicitly separate internal from external networks. Adding 'ip access-list' explicitly permitting and denying internal and external networks enforces these policies."
      solution    : "Configure ACL for private source address restrictions from external networks.


hostname(config)#ip access-list extended {<span><em>name | number</em>}
</span><span>hostname(config-nacl)#deny ip {</span><em>internal_networks</em>} any log
hostname(config<span>-nacl</span>)#deny ip 127.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 10.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 0.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 172.16.0.0 0.15.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.168.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.0.2.0 0.0.0.255 any log
hostname(config<span>-nacl</span>)#deny ip 169.254.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 224.0.0.0 31.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip host 255.255.255.255 any log
hostname(config<span>-nacl</span>)#permit {protocol} {source_ip} {source_mask} {destination} {destination_mask} log
hostname(config<span>-nacl</span>)#deny any any log
hostname(config)#interface <external_<em>interface</em>>
hostname(config-if)#access-group <<em>access-list</em>> in


Default Value:

No access list defined"
      reference   : "CIS_Recommendation|3.2.1,CSCv6|11,CSCv7|11,LEVEL|2M,PCI-DSSv3.2|1.2.1"
      see_also    : "https://workbench.cisecurity.org/files/3156"
# Note: Variable @AG_INGRESS_ACL@ replaced with "3" in field "context".
      context     : "ip access-list extended 3$"
      regex       : "deny +ip 169\\.254\\.0\\.0 0\\.0\\.255\\.255 any log"
      item        : "deny +ip 169\\.254\\.0\\.0 .+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "3.2.1 Set 'ip access-list extended' to Forbid Private Source Addresses from External Networks - 'Deny 224.0.0.0'"
      info        : "This command places the router in access-list configuration mode, where you must define the denied or permitted access conditions by using the deny and permit commands.

Rationale:

Configuring access controls can help prevent spoofing attacks. To reduce the effectiveness of IP spoofing, configure access control to deny any traffic from the external network that has a source address that should reside on the internal network. Include local host address or any reserved private addresses (RFC 1918).

Ensure the permit rule(s) above the final deny rule only allow traffic according to your organization's least privilege policy.

Impact:

Organizations should plan and implement enterprise security policies that explicitly separate internal from external networks. Adding 'ip access-list' explicitly permitting and denying internal and external networks enforces these policies."
      solution    : "Configure ACL for private source address restrictions from external networks.


hostname(config)#ip access-list extended {<span><em>name | number</em>}
</span><span>hostname(config-nacl)#deny ip {</span><em>internal_networks</em>} any log
hostname(config<span>-nacl</span>)#deny ip 127.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 10.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 0.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 172.16.0.0 0.15.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.168.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.0.2.0 0.0.0.255 any log
hostname(config<span>-nacl</span>)#deny ip 169.254.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 224.0.0.0 31.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip host 255.255.255.255 any log
hostname(config<span>-nacl</span>)#permit {protocol} {source_ip} {source_mask} {destination} {destination_mask} log
hostname(config<span>-nacl</span>)#deny any any log
hostname(config)#interface <external_<em>interface</em>>
hostname(config-if)#access-group <<em>access-list</em>> in


Default Value:

No access list defined"
      reference   : "CIS_Recommendation|3.2.1,CSCv6|11,CSCv7|11,LEVEL|2M,PCI-DSSv3.2|1.2.1"
      see_also    : "https://workbench.cisecurity.org/files/3156"
# Note: Variable @AG_INGRESS_ACL@ replaced with "3" in field "context".
      context     : "ip access-list extended 3$"
      regex       : "deny +ip 224\\.0\\.0\\.0 31\\.255\\.255\\.255 any log"
      item        : "deny +ip 224\\.0\\.0\\.0 .+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "3.2.1 Set 'ip access-list extended' to Forbid Private Source Addresses from External Networks - 'Deny host 255.255.255.255'"
      info        : "This command places the router in access-list configuration mode, where you must define the denied or permitted access conditions by using the deny and permit commands.

Rationale:

Configuring access controls can help prevent spoofing attacks. To reduce the effectiveness of IP spoofing, configure access control to deny any traffic from the external network that has a source address that should reside on the internal network. Include local host address or any reserved private addresses (RFC 1918).

Ensure the permit rule(s) above the final deny rule only allow traffic according to your organization's least privilege policy.

Impact:

Organizations should plan and implement enterprise security policies that explicitly separate internal from external networks. Adding 'ip access-list' explicitly permitting and denying internal and external networks enforces these policies."
      solution    : "Configure ACL for private source address restrictions from external networks.


hostname(config)#ip access-list extended {<span><em>name | number</em>}
</span><span>hostname(config-nacl)#deny ip {</span><em>internal_networks</em>} any log
hostname(config<span>-nacl</span>)#deny ip 127.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 10.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 0.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 172.16.0.0 0.15.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.168.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.0.2.0 0.0.0.255 any log
hostname(config<span>-nacl</span>)#deny ip 169.254.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 224.0.0.0 31.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip host 255.255.255.255 any log
hostname(config<span>-nacl</span>)#permit {protocol} {source_ip} {source_mask} {destination} {destination_mask} log
hostname(config<span>-nacl</span>)#deny any any log
hostname(config)#interface <external_<em>interface</em>>
hostname(config-if)#access-group <<em>access-list</em>> in


Default Value:

No access list defined"
      reference   : "CIS_Recommendation|3.2.1,CSCv6|11,CSCv7|11,LEVEL|2M,PCI-DSSv3.2|1.2.1"
      see_also    : "https://workbench.cisecurity.org/files/3156"
# Note: Variable @AG_INGRESS_ACL@ replaced with "3" in field "context".
      context     : "ip access-list extended 3$"
      regex       : "deny +ip host 255\\.255\\.255\\.255 any log"
      item        : "deny +ip host 255\\.255\\.255\\.255 .+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "3.2.1 Set 'ip access-list extended' to Forbid Private Source Addresses from External Networks - 'Default deny configured'"
      info        : "This command places the router in access-list configuration mode, where you must define the denied or permitted access conditions by using the deny and permit commands.

Rationale:

Configuring access controls can help prevent spoofing attacks. To reduce the effectiveness of IP spoofing, configure access control to deny any traffic from the external network that has a source address that should reside on the internal network. Include local host address or any reserved private addresses (RFC 1918).

Ensure the permit rule(s) above the final deny rule only allow traffic according to your organization's least privilege policy.

Impact:

Organizations should plan and implement enterprise security policies that explicitly separate internal from external networks. Adding 'ip access-list' explicitly permitting and denying internal and external networks enforces these policies."
      solution    : "Configure ACL for private source address restrictions from external networks.


hostname(config)#ip access-list extended {<span><em>name | number</em>}
</span><span>hostname(config-nacl)#deny ip {</span><em>internal_networks</em>} any log
hostname(config<span>-nacl</span>)#deny ip 127.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 10.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 0.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 172.16.0.0 0.15.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.168.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.0.2.0 0.0.0.255 any log
hostname(config<span>-nacl</span>)#deny ip 169.254.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 224.0.0.0 31.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip host 255.255.255.255 any log
hostname(config<span>-nacl</span>)#permit {protocol} {source_ip} {source_mask} {destination} {destination_mask} log
hostname(config<span>-nacl</span>)#deny any any log
hostname(config)#interface <external_<em>interface</em>>
hostname(config-if)#access-group <<em>access-list</em>> in


Default Value:

No access list defined"
      reference   : "CIS_Recommendation|3.2.1,CSCv6|11,CSCv7|11,LEVEL|2M,PCI-DSSv3.2|1.2.1"
      see_also    : "https://workbench.cisecurity.org/files/3156"
# Note: Variable @AG_INGRESS_ACL@ replaced with "3" in field "context".
      context     : "ip access-list extended 3$"
      regex       : "deny +ip any any log"
      item        : "deny +ip any .+"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "3.2.1 Set 'ip access-list extended' to Forbid Private Source Addresses from External Networks - External interface has ACL applied"
      info        : "This command places the router in access-list configuration mode, where you must define the denied or permitted access conditions by using the deny and permit commands.

Rationale:

Configuring access controls can help prevent spoofing attacks. To reduce the effectiveness of IP spoofing, configure access control to deny any traffic from the external network that has a source address that should reside on the internal network. Include local host address or any reserved private addresses (RFC 1918).

Ensure the permit rule(s) above the final deny rule only allow traffic according to your organization's least privilege policy.

Impact:

Organizations should plan and implement enterprise security policies that explicitly separate internal from external networks. Adding 'ip access-list' explicitly permitting and denying internal and external networks enforces these policies."
      solution    : "Configure ACL for private source address restrictions from external networks.


hostname(config)#ip access-list extended {<span><em>name | number</em>}
</span><span>hostname(config-nacl)#deny ip {</span><em>internal_networks</em>} any log
hostname(config<span>-nacl</span>)#deny ip 127.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 10.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 0.0.0.0 0.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 172.16.0.0 0.15.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.168.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 192.0.2.0 0.0.0.255 any log
hostname(config<span>-nacl</span>)#deny ip 169.254.0.0 0.0.255.255 any log
hostname(config<span>-nacl</span>)#deny ip 224.0.0.0 31.255.255.255 any log
hostname(config<span>-nacl</span>)#deny ip host 255.255.255.255 any log
hostname(config<span>-nacl</span>)#permit {protocol} {source_ip} {source_mask} {destination} {destination_mask} log
hostname(config<span>-nacl</span>)#deny any any log
hostname(config)#interface <external_<em>interface</em>>
hostname(config-if)#access-group <<em>access-list</em>> in


Default Value:

No access list defined"
      reference   : "CIS_Recommendation|3.2.1,CSCv6|11,CSCv7|11,LEVEL|2M,PCI-DSSv3.2|1.2.1"
      see_also    : "https://workbench.cisecurity.org/files/3156"
# Note: Variable @EXTERNAL_INTERFACE@ replaced with "FastEthernet0/1" in field "context".
      context     : "interface FastEthernet0/1"
# Note: Variable @AG_INGRESS_ACL@ replaced with "3" in field "item".
      item        : "ip access-group 3 in"
    </item>

    <item>
      type        : CONFIG_CHECK
      description : "3.2.2 Set inbound 'ip access-group' on the External Interface"
      info        : "This command places the router in access-list configuration mode, where you must define the denied or permitted access conditions by using the deny and permit commands.

Rationale:

Configuring access controls can help prevent spoofing attacks. To reduce the effectiveness of IP spoofing, configure access control to deny any traffic from the external network that has a source address that should reside on the internal network. Include local host address or any reserved private addresses (RFC 1918).

Ensure the permit rule(s) above the final deny rule only allow traffic according to your organization's least privilege policy.

Impact:

Organizations should plan and implement enterprise security policies explicitly permitting and denying access based upon access lists. Using the 'ip access-group' command enforces these policies by explicitly identifying groups permitted access."
      solution    : "Apply the access-group for the external (untrusted) interface


hostname(config)#interface {external_interface}
hostname(config-if)#ip access-group {name | number} in

Default Value:

No access-group defined"
      reference   : "800-171|3.13.1,800-53|SC-7(11),CIS_Recommendation|3.2.2,CN-L3|8.1.10.6(j),CSCv6|11,CSCv7|11,CSF|PR.AC-5,CSF|PR.PT-4,ISO/IEC-27001|A.13.1.3,ITSG-33|SC-7(11),LEVEL|2M,NESA|T4.5.4,NIAv2|GS7c,PCI-DSSv3.2|1.2.1,QCSC-v1|5.2.1,QCSC-v1|5.2.2,QCSC-v1|6.2,QCSC-v1|8.2.1,TBA-FIISB|31.3"
      see_also    : "https://workbench.cisecurity.org/files/3156"
# Note: Variable @EXTERNAL_INTERFACE@ replaced with "FastEthernet0/1" in field "context".
      context     : "interface FastEthernet0/1"
# Note: Variable @INTERNAL_NETWORK_INGRESS_ACL@ replaced with "1" in field "item".
      item        : "ip access-group 1 in"
    </item>

#
## 3.3 Neighbor Authentication
#

    <if>
      <condition type:"AND">
        <item>
          type        : CONFIG_CHECK
          description : "EIGRP is enabled"
          item        : "router eigrp .+"
        </item>
      </condition>

      <then>
        <item>
          type        : CONFIG_CHECK
          description : "3.3.1.1 Set 'key chain'"
          info        : "Define an authentication key chain to enable authentication for routing protocols. A key chain must have at least one key and can have up to 2,147,483,647 keys.

NOTE: Only DRP Agent, EIGRP, and RIPv2 use key chains.

Rationale:

Routing protocols such as DRP Agent, EIGRP, and RIPv2 use key chains for authentication.

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using 'key chains' for routing protocols enforces these policies."
          solution    : "Establish the key chain.


hostname(config)#key chain {<em>key-chain_name</em>}

Default Value:

Not set"
          reference   : "800-53|IA-3.,CIS_Recommendation|3.3.1.1,CSCv6|11,CSCv7|11,CSF|PR.AC-1,ITSG-33|IA-3,ITSG-33|IA-3a.,LEVEL|2M,NESA|T5.4.3,PCI-DSSv3.2|3.6.2,QCSC-v1|13.2,TBA-FIISB|27.1"
          see_also    : "https://workbench.cisecurity.org/files/3156"
# Note: Variable @KEY_CHAIN_NAME@ replaced with "eigrp-keys" in field "regex".
          regex       : "key chain eigrp-keys"
          item        : "key chain .+"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "3.3.1.2 Set 'key'"
          info        : "Configure an authentication key on a key chain.

Rationale:

This is part of the routing authentication setup

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using 'key numbers' for key chains for routing protocols enforces these policies."
          solution    : "Configure the key number.


hostname(config-keychain)#key {<em>key-number</em>}"
          reference   : "CIS_Recommendation|3.3.1.2,CSCv6|11,CSCv7|11,LEVEL|2M,PCI-DSSv3.2|3.6"
          see_also    : "https://workbench.cisecurity.org/files/3156"
          context     : "key chain .+"
          item        : "key .+"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "3.3.1.3 Set 'key-string'"
          info        : "Configure the authentication string for a key.

Rationale:

This is part of the routing authentication setup

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using 'key strings' for key chains for routing protocols enforces these policies."
          solution    : "Configure the key string.


hostname(config-keychain-key)#key-string <<em>key-string</em>>

Default Value:

Not set"
          reference   : "800-53|IA-3.,CIS_Recommendation|3.3.1.3,CSCv6|11,CSCv7|11,CSF|PR.AC-1,ITSG-33|IA-3,ITSG-33|IA-3a.,LEVEL|2M,NESA|T5.4.3,PCI-DSSv3.2|3.6,QCSC-v1|13.2,TBA-FIISB|27.1"
          see_also    : "https://workbench.cisecurity.org/files/3156"
          context     : "key chain .+"
          item        : "key-string .+"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "3.3.1.4 Set 'address-family ipv4 autonomous-system'"
          info        : "Configure the EIGRP address family.

Rationale:

Rationale: EIGRP is a true multi-protocol routing protocol and the 'address-family' feature enables restriction of exchanges with specific neighbors

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using 'address-family' for EIGRP enforces these policies by restricting the exchanges between predefined network devices."
          solution    : "Configure the EIGRP address family.


hostname(config)#router eigrp <<em>virtual-instance-name</em>>
hostname(config-router)#address-family ipv4 autonomous-system {<em>eigrp_as-number</em>}

Default Value:

Not set"
          reference   : "800-53|IA-3.,CIS_Recommendation|3.3.1.4,CSCv6|11,CSCv7|11,CSF|PR.AC-1,ITSG-33|IA-3,ITSG-33|IA-3a.,LEVEL|2M,NESA|T5.4.3,PCI-DSSv3.2|1.2.1,PCI-DSSv3.2|1.3.7,QCSC-v1|13.2,TBA-FIISB|27.1"
          see_also    : "https://workbench.cisecurity.org/files/3156"
          context     : "router eigrp .+"
          item        : "address-family ipv4.*autonomous-system [0-9]+"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "3.3.1.5 Set 'af-interface default'"
          info        : "Defines user defaults to apply to EIGRP interfaces that belong to an address-family.

Rationale:

Part of the EIGRP address-family setup

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using 'af-interface default' for EIGRP interfaces enforces these policies by restricting the exchanges between predefined network devices."
          solution    : "Configure the EIGRP address family.


hostname(config)#router eigrp <<em>virtual-instance-name</em>>
hostname(config-router)#address-family ipv4 autonomous-system {<em>eigrp_as-number</em>}
hostname(config-router-af)#af-interface default

Default Value:

Not set"
          reference   : "800-53|IA-3.,CIS_Recommendation|3.3.1.5,CSCv6|11,CSCv7|11,CSF|PR.AC-1,ITSG-33|IA-3,ITSG-33|IA-3a.,LEVEL|2M,NESA|T5.4.3,PCI-DSSv3.2|1.2.1,PCI-DSSv3.2|1.3.7,QCSC-v1|13.2,TBA-FIISB|27.1"
          see_also    : "https://workbench.cisecurity.org/files/3156"
          context     : "router eigrp .+"
          item        : "af-interface default"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "3.3.1.6 Set 'authentication key-chain'"
          info        : "Configure the EIGRP address family key chain.

Rationale:

This is part of the EIGRP authentication configuration

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using the address-family 'key chain' for EIGRP enforces these policies by restricting the exchanges between predefined network devices."
          solution    : "Configure the EIGRP address family key chain.


hostname(config)#router eigrp <virtual-instance-name>
hostname(config-router)#address-family ipv4 autonomous-system {eigrp_as-number}
hostname(config-router-af)#af-interface {interface-name}
hostname(config-router-af-interface)#authentication key-chain {eigrp_key-chain_name}

Default Value:

No key chains are specified for EIGRP"
          reference   : "800-53|IA-3.,CIS_Recommendation|3.3.1.6,CSCv6|11,CSCv7|11,CSF|PR.AC-1,ITSG-33|IA-3,ITSG-33|IA-3a.,LEVEL|2M,NESA|T5.4.3,PCI-DSSv3.2|4.1,QCSC-v1|13.2,TBA-FIISB|27.1"
          see_also    : "https://workbench.cisecurity.org/files/3156"
          context     : "router eigrp .+"
# Note: Variable @KEY_CHAIN_NAME@ replaced with "eigrp-keys" in field "regex".
          regex       : "authentication key-chain eigrp-keys"
          item        : "authentication key-chain .+"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "3.3.1.7 Set 'authentication mode md5'"
          info        : "Configure authentication to prevent unapproved sources from introducing unauthorized or false service messages.

Rationale:

This is part of the EIGRP authentication configuration

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using the 'authentication mode' for EIGRP address-family or service-family packets enforces these policies by restricting the type of authentication between network devices."
          solution    : "Configure the EIGRP address family authentication mode.


hostname(config)#router eigrp <virtual-instance-name>
hostname(config-router)#address-family ipv4 autonomous-system {eigrp_as-number}
hostname(config-router-af)#af-interface {interface-name}
hostname(config-router-af-interface)#authentication mode md5

Default Value:

Not defined"
          reference   : "800-171|3.13.8,800-53|SC-8(1),CIS_Recommendation|3.3.1.7,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv6|11,CSCv7|11,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),LEVEL|2M,NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|4.1,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|2.1,TBA-FIISB|29.1"
          see_also    : "https://workbench.cisecurity.org/files/3156"
          context     : "router eigrp .+"
          item        : "authentication mode md5"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "3.3.1.8 Set 'ip authentication key-chain eigrp'"
          info        : "Specify the type of authentication used in Enhanced Interior Gateway Routing Protocol (EIGRP) packets per interface.

Rationale:

Configuring EIGRP authentication key-chain number and name to restrict packet exchanges between network devices.

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Configuring the interface with 'ip authentication key chain' for EIGRP by name and number enforces these policies by restricting the exchanges between network devices."
          solution    : "Configure the interface with the EIGRP key chain.


hostname(config)#interface {<em>interface_name</em>}
hostname(config-if)#ip authentication key-chain eigrp {<em>eigrp_as-number</em>} {<em>eigrp_key-chain_name</em>}

Default Value:

Not set"
          reference   : "800-171|3.13.8,800-53|SC-8(1),CIS_Recommendation|3.3.1.8,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv6|11,CSCv7|11,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),LEVEL|2M,NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|4.1,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|2.1,TBA-FIISB|29.1"
          see_also    : "https://workbench.cisecurity.org/files/3156"
          context     : "interface .+"
# Note: Variable @AS_NUMBER@ replaced with "100" in field "regex".
# Note: Variable @KEY_CHAIN_NAME@ replaced with "eigrp-keys" in field "regex".
          regex       : "ip authentication key-chain eigrp 100 eigrp-keys"
          item        : "ip authentication key-chain eigrp"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "3.3.1.9 Set 'ip authentication mode eigrp'"
          info        : "Configure authentication to prevent unapproved sources from introducing unauthorized or false routing messages.

Rationale:

This is part of the EIGRP authentication configuration

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Configuring the interface with 'ip authentication mode' for EIGRP by number and mode enforces these policies by restricting the exchanges between network devices."
          solution    : "Configure the interface with the EIGRP authentication mode.


hostname(config)#interface {<em>interface_name</em>}
hostname(config-if)#ip authentication mode eigrp {<em><span>eigrp_as-number</span></em><span>}</span> md5

Default Value:

Not set"
          reference   : "800-171|3.13.8,800-53|SC-8(1),CIS_Recommendation|3.3.1.9,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv6|11,CSCv7|11,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),LEVEL|2M,NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|4.1,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|2.1,TBA-FIISB|29.1"
          see_also    : "https://workbench.cisecurity.org/files/3156"
          context     : "interface .+"
# Note: Variable @AS_NUMBER@ replaced with "100" in field "regex".
          regex       : "ip authentication mode eigrp 100 md5"
          item        : "ip authentication mode eigrp"
        </item>
      </then>

      <else>
        <report type:"PASSED">
          description : "3.3.1.1 Set 'key chain'"
          info        : "Define an authentication key chain to enable authentication for routing protocols. A key chain must have at least one key and can have up to 2,147,483,647 keys.

NOTE: Only DRP Agent, EIGRP, and RIPv2 use key chains.

Rationale:

Routing protocols such as DRP Agent, EIGRP, and RIPv2 use key chains for authentication.

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using 'key chains' for routing protocols enforces these policies."
          solution    : "Establish the key chain.


hostname(config)#key chain {<em>key-chain_name</em>}

Default Value:

Not set"
          reference   : "800-53|IA-3.,CIS_Recommendation|3.3.1.1,CSCv6|11,CSCv7|11,CSF|PR.AC-1,ITSG-33|IA-3,ITSG-33|IA-3a.,LEVEL|2M,NESA|T5.4.3,PCI-DSSv3.2|3.6.2,QCSC-v1|13.2,TBA-FIISB|27.1"
          see_also    : "https://workbench.cisecurity.org/files/3156"
        </report>

        <report type:"PASSED">
          description : "3.3.1.2 Set 'key'"
          info        : "Configure an authentication key on a key chain.

Rationale:

This is part of the routing authentication setup

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using 'key numbers' for key chains for routing protocols enforces these policies."
          solution    : "Configure the key number.


hostname(config-keychain)#key {<em>key-number</em>}"
          reference   : "CIS_Recommendation|3.3.1.2,CSCv6|11,CSCv7|11,LEVEL|2M,PCI-DSSv3.2|3.6"
          see_also    : "https://workbench.cisecurity.org/files/3156"
        </report>

        <report type:"PASSED">
          description : "3.3.1.3 Set 'key-string'"
          info        : "Configure the authentication string for a key.

Rationale:

This is part of the routing authentication setup

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using 'key strings' for key chains for routing protocols enforces these policies."
          solution    : "Configure the key string.


hostname(config-keychain-key)#key-string <<em>key-string</em>>

Default Value:

Not set"
          reference   : "800-53|IA-3.,CIS_Recommendation|3.3.1.3,CSCv6|11,CSCv7|11,CSF|PR.AC-1,ITSG-33|IA-3,ITSG-33|IA-3a.,LEVEL|2M,NESA|T5.4.3,PCI-DSSv3.2|3.6,QCSC-v1|13.2,TBA-FIISB|27.1"
          see_also    : "https://workbench.cisecurity.org/files/3156"
        </report>

        <report type:"PASSED">
          description : "3.3.1.4 Set 'address-family ipv4 autonomous-system'"
          info        : "Configure the EIGRP address family.

Rationale:

Rationale: EIGRP is a true multi-protocol routing protocol and the 'address-family' feature enables restriction of exchanges with specific neighbors

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using 'address-family' for EIGRP enforces these policies by restricting the exchanges between predefined network devices."
          solution    : "Configure the EIGRP address family.


hostname(config)#router eigrp <<em>virtual-instance-name</em>>
hostname(config-router)#address-family ipv4 autonomous-system {<em>eigrp_as-number</em>}

Default Value:

Not set"
          reference   : "800-53|IA-3.,CIS_Recommendation|3.3.1.4,CSCv6|11,CSCv7|11,CSF|PR.AC-1,ITSG-33|IA-3,ITSG-33|IA-3a.,LEVEL|2M,NESA|T5.4.3,PCI-DSSv3.2|1.2.1,PCI-DSSv3.2|1.3.7,QCSC-v1|13.2,TBA-FIISB|27.1"
          see_also    : "https://workbench.cisecurity.org/files/3156"
        </report>

        <report type:"PASSED">
          description : "3.3.1.5 Set 'af-interface default'"
          info        : "Defines user defaults to apply to EIGRP interfaces that belong to an address-family.

Rationale:

Part of the EIGRP address-family setup

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using 'af-interface default' for EIGRP interfaces enforces these policies by restricting the exchanges between predefined network devices."
          solution    : "Configure the EIGRP address family.


hostname(config)#router eigrp <<em>virtual-instance-name</em>>
hostname(config-router)#address-family ipv4 autonomous-system {<em>eigrp_as-number</em>}
hostname(config-router-af)#af-interface default

Default Value:

Not set"
          reference   : "800-53|IA-3.,CIS_Recommendation|3.3.1.5,CSCv6|11,CSCv7|11,CSF|PR.AC-1,ITSG-33|IA-3,ITSG-33|IA-3a.,LEVEL|2M,NESA|T5.4.3,PCI-DSSv3.2|1.2.1,PCI-DSSv3.2|1.3.7,QCSC-v1|13.2,TBA-FIISB|27.1"
          see_also    : "https://workbench.cisecurity.org/files/3156"
        </report>

        <report type:"PASSED">
          description : "3.3.1.6 Set 'authentication key-chain'"
          info        : "Configure the EIGRP address family key chain.

Rationale:

This is part of the EIGRP authentication configuration

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using the address-family 'key chain' for EIGRP enforces these policies by restricting the exchanges between predefined network devices."
          solution    : "Configure the EIGRP address family key chain.


hostname(config)#router eigrp <virtual-instance-name>
hostname(config-router)#address-family ipv4 autonomous-system {eigrp_as-number}
hostname(config-router-af)#af-interface {interface-name}
hostname(config-router-af-interface)#authentication key-chain {eigrp_key-chain_name}

Default Value:

No key chains are specified for EIGRP"
          reference   : "800-53|IA-3.,CIS_Recommendation|3.3.1.6,CSCv6|11,CSCv7|11,CSF|PR.AC-1,ITSG-33|IA-3,ITSG-33|IA-3a.,LEVEL|2M,NESA|T5.4.3,PCI-DSSv3.2|4.1,QCSC-v1|13.2,TBA-FIISB|27.1"
          see_also    : "https://workbench.cisecurity.org/files/3156"
        </report>

        <report type:"PASSED">
          description : "3.3.1.7 Set 'authentication mode md5'"
          info        : "Configure authentication to prevent unapproved sources from introducing unauthorized or false service messages.

Rationale:

This is part of the EIGRP authentication configuration

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using the 'authentication mode' for EIGRP address-family or service-family packets enforces these policies by restricting the type of authentication between network devices."
          solution    : "Configure the EIGRP address family authentication mode.


hostname(config)#router eigrp <virtual-instance-name>
hostname(config-router)#address-family ipv4 autonomous-system {eigrp_as-number}
hostname(config-router-af)#af-interface {interface-name}
hostname(config-router-af-interface)#authentication mode md5

Default Value:

Not defined"
          reference   : "800-171|3.13.8,800-53|SC-8(1),CIS_Recommendation|3.3.1.7,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv6|11,CSCv7|11,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),LEVEL|2M,NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|4.1,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|2.1,TBA-FIISB|29.1"
          see_also    : "https://workbench.cisecurity.org/files/3156"
        </report>

        <report type:"PASSED">
          description : "3.3.1.8 Set 'ip authentication key-chain eigrp'"
          info        : "Specify the type of authentication used in Enhanced Interior Gateway Routing Protocol (EIGRP) packets per interface.

Rationale:

Configuring EIGRP authentication key-chain number and name to restrict packet exchanges between network devices.

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Configuring the interface with 'ip authentication key chain' for EIGRP by name and number enforces these policies by restricting the exchanges between network devices."
          solution    : "Configure the interface with the EIGRP key chain.


hostname(config)#interface {<em>interface_name</em>}
hostname(config-if)#ip authentication key-chain eigrp {<em>eigrp_as-number</em>} {<em>eigrp_key-chain_name</em>}

Default Value:

Not set"
          reference   : "800-171|3.13.8,800-53|SC-8(1),CIS_Recommendation|3.3.1.8,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv6|11,CSCv7|11,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),LEVEL|2M,NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|4.1,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|2.1,TBA-FIISB|29.1"
          see_also    : "https://workbench.cisecurity.org/files/3156"
        </report>

        <report type:"PASSED">
          description : "3.3.1.9 Set 'ip authentication mode eigrp'"
          info        : "Configure authentication to prevent unapproved sources from introducing unauthorized or false routing messages.

Rationale:

This is part of the EIGRP authentication configuration

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Configuring the interface with 'ip authentication mode' for EIGRP by number and mode enforces these policies by restricting the exchanges between network devices."
          solution    : "Configure the interface with the EIGRP authentication mode.


hostname(config)#interface {<em>interface_name</em>}
hostname(config-if)#ip authentication mode eigrp {<em><span>eigrp_as-number</span></em><span>}</span> md5

Default Value:

Not set"
          reference   : "800-171|3.13.8,800-53|SC-8(1),CIS_Recommendation|3.3.1.9,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv6|11,CSCv7|11,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),LEVEL|2M,NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|4.1,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|2.1,TBA-FIISB|29.1"
          see_also    : "https://workbench.cisecurity.org/files/3156"
        </report>
      </else>
    </if>

    <if>
      <condition type:"AND">
        <item>
          type        : CONFIG_CHECK
          description : "OSPF is enabled"
          item        : "router ospf .+"
        </item>
      </condition>

      <then>
        <item>
          type        : CONFIG_CHECK
          description : "3.3.2.1 Set 'authentication message-digest' for OSPF area"
          info        : "Enable MD5 authentication for OSPF.

Rationale:

This is part of the OSPF authentication setup.

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Configuring the area 'authentication message-digest' for OSPF enforces these policies by restricting exchanges between network devices."
          solution    : "Configure the Message Digest option for OSPF.


hostname(config)#router ospf <<em>ospf_process-id</em>>
hostname(config-router)#area <<em>ospf_area-id</em>> authentication message-digest

Default Value:

Not set"
          reference   : "CIS_Recommendation|3.3.2.1,CSCv6|11,CSCv7|11,LEVEL|2M,PCI-DSSv3.2|4.1"
          see_also    : "https://workbench.cisecurity.org/files/3156"
          context     : "router ospf .+"
          item        : "area [^ ]+ authentication message-digest"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "3.3.2.2 Set 'ip ospf message-digest-key md5'"
          info        : "Enable Open Shortest Path First (OSPF) Message Digest 5 (MD5) authentication.

Rationale:

This is part of the OSPF authentication setup

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Configuring the proper interface(s) for 'ip ospf message-digest-key md5' enforces these policies by restricting exchanges between network devices."
          solution    : "Configure the appropriate interface(s) for Message Digest authentication


hostname(config)#interface {<em>interface_name</em>}
hostname(config-if)#ip ospf message-digest-key {<em>ospf_md5_key-id</em>} md5 {<em>ospf_md5_key</em>}

Default Value:

Not set"
          reference   : "800-171|3.13.8,800-53|SC-8(1),CIS_Recommendation|3.3.2.2,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv6|11,CSCv7|11,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),LEVEL|2M,NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|4.1,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|2.1,TBA-FIISB|29.1"
          see_also    : "https://workbench.cisecurity.org/files/3156"
          context     : "interface .+"
# Note: Variable @OSPF_KEY_ID@ replaced with "1" in field "regex".
          regex       : "ip ospf message-digest-key 1 md5 ([A-Za-z0-9]+)"
# Note: Variable @OSPF_KEY_ID@ replaced with "1" in field "item".
          item        : "ip ospf message-digest-key 1"
        </item>
      </then>

      <else>
        <report type:"PASSED">
          description : "3.3.2.1 Set 'authentication message-digest' for OSPF area"
          info        : "Enable MD5 authentication for OSPF.

Rationale:

This is part of the OSPF authentication setup.

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Configuring the area 'authentication message-digest' for OSPF enforces these policies by restricting exchanges between network devices."
          solution    : "Configure the Message Digest option for OSPF.


hostname(config)#router ospf <<em>ospf_process-id</em>>
hostname(config-router)#area <<em>ospf_area-id</em>> authentication message-digest

Default Value:

Not set"
          reference   : "CIS_Recommendation|3.3.2.1,CSCv6|11,CSCv7|11,LEVEL|2M,PCI-DSSv3.2|4.1"
          see_also    : "https://workbench.cisecurity.org/files/3156"
        </report>

        <report type:"PASSED">
          description : "3.3.2.2 Set 'ip ospf message-digest-key md5'"
          info        : "Enable Open Shortest Path First (OSPF) Message Digest 5 (MD5) authentication.

Rationale:

This is part of the OSPF authentication setup

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Configuring the proper interface(s) for 'ip ospf message-digest-key md5' enforces these policies by restricting exchanges between network devices."
          solution    : "Configure the appropriate interface(s) for Message Digest authentication


hostname(config)#interface {<em>interface_name</em>}
hostname(config-if)#ip ospf message-digest-key {<em>ospf_md5_key-id</em>} md5 {<em>ospf_md5_key</em>}

Default Value:

Not set"
          reference   : "800-171|3.13.8,800-53|SC-8(1),CIS_Recommendation|3.3.2.2,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv6|11,CSCv7|11,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),LEVEL|2M,NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|4.1,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|2.1,TBA-FIISB|29.1"
          see_also    : "https://workbench.cisecurity.org/files/3156"
        </report>
      </else>
    </if>

    <if>
      <condition type:"AND">
        <item>
          type        : CONFIG_CHECK
          description : "RIP is enabled"
          context     : "interface .+"
          regex       : "ip rip"
          item        : "ip rip"
        </item>
      </condition>

      <then>
        <item>
          type        : CONFIG_CHECK
          description : "3.3.3.1 Set 'key chain'"
          info        : "Define an authentication key chain to enable authentication for RIPv2 routing protocols.

Rationale:

This is part of the routing authentication process.

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Configuring the proper authentication 'key-chain (name)' for RIPv2 protocols enforces these policies by restricting acceptable authentication between network devices."
          solution    : "Establish the key chain.


hostname(config)#key chain {<em>rip_key-chain_name</em>}

Default Value:

Not set"
          reference   : "800-53|IA-3.,CIS_Recommendation|3.3.3.1,CSCv6|11,CSCv7|11,CSF|PR.AC-1,ITSG-33|IA-3,ITSG-33|IA-3a.,LEVEL|2M,NESA|T5.4.3,PCI-DSSv3.2|3.6.2,QCSC-v1|13.2,TBA-FIISB|27.1"
          see_also    : "https://workbench.cisecurity.org/files/3156"
# Note: Variable @RIP_KEY_CHAIN@ replaced with "rip-keys" in field "regex".
          regex       : "key chain rip-keys"
          item        : "key chain .+"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "3.3.3.2 Set 'key'"
          info        : "Configure an authentication key on a key chain.

Rationale:

This is part of the routing authentication setup

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Configuring the proper authentication 'key' for RIPv2 protocols enforces these policies by restricting acceptable authentication between network devices."
          solution    : "Configure the key number.


hostname(config-keychain)#key {<em>key-number</em>}"
          reference   : "CIS_Recommendation|3.3.3.2,CSCv6|11,CSCv7|11,LEVEL|2M,PCI-DSSv3.2|3.6"
          see_also    : "https://workbench.cisecurity.org/files/3156"
          context     : "key chain .+"
# Note: Variable @RIP_KEY_NUMBER@ replaced with "key_number" in field "item".
          item        : "key key_number"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "3.3.3.3 Set 'key-string'"
          info        : "Configure the authentication string for a key.

Rationale:

This is part of the routing authentication setup

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using 'key-string' for key chains for routing protocols enforces these policies."
          solution    : "Configure the key string.


hostname(config-keychain-key)#key-string <<em>key-string</em>>

Default Value:

Not set"
          reference   : "800-53|IA-3.,CIS_Recommendation|3.3.3.3,CSCv6|11,CSCv7|11,CSF|PR.AC-1,ITSG-33|IA-3,ITSG-33|IA-3a.,LEVEL|2M,NESA|T5.4.3,PCI-DSSv3.2|3.6,QCSC-v1|13.2,TBA-FIISB|27.1"
          see_also    : "https://workbench.cisecurity.org/files/3156"
          context     : "key chain .+"
          item        : "key-string .+"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "3.3.3.4 Set 'ip rip authentication key-chain'"
          info        : "Enable authentication for Routing Information Protocol (RIP) Version 2 packets and to specify the set of keys that can be used on an interface.

Rationale:

This is part of the RIPv2 authentication setup

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Configuring the interface with 'ip rip authentication key-chain' by name enforces these policies by restricting the exchanges between network devices."
          solution    : "Configure the Interface with the RIPv2 key chain.


hostname(config)#interface {<em>interface_name</em>}
hostname(config-if)#ip rip authentication key-chain {<em>rip_key-chain_name</em>}

Default Value:

Not set"
          reference   : "800-171|3.13.8,800-53|SC-8(1),CIS_Recommendation|3.3.3.4,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv6|11,CSCv7|11,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),LEVEL|2M,NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|4.1,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|2.1,TBA-FIISB|29.1"
          see_also    : "https://workbench.cisecurity.org/files/3156"
          context     : "interface .+"
# Note: Variable @RIP_KEY_CHAIN@ replaced with "rip-keys" in field "regex".
          regex       : "ip rip authentication key-chain rip-keys"
          item        : "ip rip authentication key-chain"
        </item>

        <item>
          type        : CONFIG_CHECK
          description : "3.3.3.5 Set 'ip rip authentication mode' to 'md5'"
          info        : "Configure the Interface with the RIPv2 key chain.

Rationale:

This is part of the RIPv2 authentication setup

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using the 'ip rip authentication mode md5' enforces these policies by restricting the type of authentication between network devices."
          solution    : "Configure the RIPv2 authentication mode on the necessary interface(s)


hostname(config)#interface <<em>interface_name</em>>
hostname(config-if)#ip rip authentication mode md5

Default Value:

Not set"
          reference   : "800-171|3.13.8,800-53|SC-8(1),CIS_Recommendation|3.3.3.5,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv6|11,CSCv7|11,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),LEVEL|2M,NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|4.1,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|2.1,TBA-FIISB|29.1"
          see_also    : "https://workbench.cisecurity.org/files/3156"
          context     : "interface .+"
          regex       : "ip rip authentication mode md5"
          item        : "ip rip authentication mode"
        </item>
      </then>

      <else>
        <report type:"PASSED">
          description : "3.3.3.1 Set 'key chain'"
          info        : "Define an authentication key chain to enable authentication for RIPv2 routing protocols.

Rationale:

This is part of the routing authentication process.

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Configuring the proper authentication 'key-chain (name)' for RIPv2 protocols enforces these policies by restricting acceptable authentication between network devices."
          solution    : "Establish the key chain.


hostname(config)#key chain {<em>rip_key-chain_name</em>}

Default Value:

Not set"
          reference   : "800-53|IA-3.,CIS_Recommendation|3.3.3.1,CSCv6|11,CSCv7|11,CSF|PR.AC-1,ITSG-33|IA-3,ITSG-33|IA-3a.,LEVEL|2M,NESA|T5.4.3,PCI-DSSv3.2|3.6.2,QCSC-v1|13.2,TBA-FIISB|27.1"
          see_also    : "https://workbench.cisecurity.org/files/3156"
        </report>

        <report type:"PASSED">
          description : "3.3.3.2 Set 'key'"
          info        : "Configure an authentication key on a key chain.

Rationale:

This is part of the routing authentication setup

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Configuring the proper authentication 'key' for RIPv2 protocols enforces these policies by restricting acceptable authentication between network devices."
          solution    : "Configure the key number.


hostname(config-keychain)#key {<em>key-number</em>}"
          reference   : "CIS_Recommendation|3.3.3.2,CSCv6|11,CSCv7|11,LEVEL|2M,PCI-DSSv3.2|3.6"
          see_also    : "https://workbench.cisecurity.org/files/3156"
        </report>

        <report type:"PASSED">
          description : "3.3.3.3 Set 'key-string'"
          info        : "Configure the authentication string for a key.

Rationale:

This is part of the routing authentication setup

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using 'key-string' for key chains for routing protocols enforces these policies."
          solution    : "Configure the key string.


hostname(config-keychain-key)#key-string <<em>key-string</em>>

Default Value:

Not set"
          reference   : "800-53|IA-3.,CIS_Recommendation|3.3.3.3,CSCv6|11,CSCv7|11,CSF|PR.AC-1,ITSG-33|IA-3,ITSG-33|IA-3a.,LEVEL|2M,NESA|T5.4.3,PCI-DSSv3.2|3.6,QCSC-v1|13.2,TBA-FIISB|27.1"
          see_also    : "https://workbench.cisecurity.org/files/3156"
        </report>

        <report type:"PASSED">
          description : "3.3.3.4 Set 'ip rip authentication key-chain'"
          info        : "Enable authentication for Routing Information Protocol (RIP) Version 2 packets and to specify the set of keys that can be used on an interface.

Rationale:

This is part of the RIPv2 authentication setup

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Configuring the interface with 'ip rip authentication key-chain' by name enforces these policies by restricting the exchanges between network devices."
          solution    : "Configure the Interface with the RIPv2 key chain.


hostname(config)#interface {<em>interface_name</em>}
hostname(config-if)#ip rip authentication key-chain {<em>rip_key-chain_name</em>}

Default Value:

Not set"
          reference   : "800-171|3.13.8,800-53|SC-8(1),CIS_Recommendation|3.3.3.4,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv6|11,CSCv7|11,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),LEVEL|2M,NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|4.1,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|2.1,TBA-FIISB|29.1"
          see_also    : "https://workbench.cisecurity.org/files/3156"
        </report>

        <report type:"PASSED">
          description : "3.3.3.5 Set 'ip rip authentication mode' to 'md5'"
          info        : "Configure the Interface with the RIPv2 key chain.

Rationale:

This is part of the RIPv2 authentication setup

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using the 'ip rip authentication mode md5' enforces these policies by restricting the type of authentication between network devices."
          solution    : "Configure the RIPv2 authentication mode on the necessary interface(s)


hostname(config)#interface <<em>interface_name</em>>
hostname(config-if)#ip rip authentication mode md5

Default Value:

Not set"
          reference   : "800-171|3.13.8,800-53|SC-8(1),CIS_Recommendation|3.3.3.5,CN-L3|8.1.2.2(a),CN-L3|8.1.2.2(b),CN-L3|8.1.4.7(a),CN-L3|8.1.4.8(a),CN-L3|8.2.4.5(c),CN-L3|8.2.4.5(d),CN-L3|8.5.2.2,CSCv6|11,CSCv7|11,CSF|PR.DS-2,CSF|PR.DS-5,ISO/IEC-27001|A.10.1.1,ISO/IEC-27001|A.13.2.3,ITSG-33|SC-8(1),LEVEL|2M,NESA|T7.4.1,NIAv2|NS5d,NIAv2|NS6b,PCI-DSSv3.2|4.1,QCSC-v1|5.2.2,QCSC-v1|6.2,SWIFT-CSCv1|2.1,TBA-FIISB|29.1"
          see_also    : "https://workbench.cisecurity.org/files/3156"
        </report>
      </else>
    </if>

    <if>
      <condition type:"AND">
        <item>
          type        : CONFIG_CHECK
          description : "BGP is enabled"
          item        : "router [Bb][Gg][Pp] .+"
        </item>
      </condition>

      <then>
        <item>
          type        : CONFIG_CHECK
          description : "3.3.4.1 Set 'neighbor password'"
          info        : "Enable message digest5 (MD5) authentication on a TCP connection between two BGP peers

Rationale:

Enforcing routing authentication reduces the likelihood of routing poisoning and unauthorized routers from joining BGP routing.

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using the 'neighbor password' for BGP enforces these policies by restricting the type of authentication between network devices."
          solution    : "Configure BGP neighbor authentication where feasible.


hostname(config)#router bgp <<em>bgp_as-number</em>>
hostname(config-router)#neighbor <<em>bgp_neighbor-ip</em> | <em>peer-group-name</em>> password <<em>password</em>>

Default Value:

Not set"
          reference   : "800-53|IA-3.,CIS_Recommendation|3.3.4.1,CSCv6|11,CSCv7|11,CSF|PR.AC-1,ITSG-33|IA-3,ITSG-33|IA-3a.,LEVEL|2M,NESA|T5.4.3,PCI-DSSv3.2|4.1,QCSC-v1|13.2,TBA-FIISB|27.1"
          see_also    : "https://workbench.cisecurity.org/files/3156"
          context     : "router [Bb][Gg][Pp] .+"
          regex       : "neighbor [^ ]+ password ([A-Za-z0-9\\/\\$]{30})"
          item        : "neighbor [^ ]+ password .+"
        </item>
      </then>

      <else>
        <report type:"PASSED">
          description : "3.3.4.1 Set 'neighbor password'"
          info        : "Enable message digest5 (MD5) authentication on a TCP connection between two BGP peers

Rationale:

Enforcing routing authentication reduces the likelihood of routing poisoning and unauthorized routers from joining BGP routing.

Impact:

Organizations should plan and implement enterprise security policies that require rigorous authentication methods for routing protocols. Using the 'neighbor password' for BGP enforces these policies by restricting the type of authentication between network devices."
          solution    : "Configure BGP neighbor authentication where feasible.


hostname(config)#router bgp <<em>bgp_as-number</em>>
hostname(config-router)#neighbor <<em>bgp_neighbor-ip</em> | <em>peer-group-name</em>> password <<em>password</em>>

Default Value:

Not set"
          reference   : "800-53|IA-3.,CIS_Recommendation|3.3.4.1,CSCv6|11,CSCv7|11,CSF|PR.AC-1,ITSG-33|IA-3,ITSG-33|IA-3a.,LEVEL|2M,NESA|T5.4.3,PCI-DSSv3.2|4.1,QCSC-v1|13.2,TBA-FIISB|27.1"
          see_also    : "https://workbench.cisecurity.org/files/3156"
        </report>
      </else>
    </if>
  </then>

  <else>
    <report type:"WARNING">
      description : "CIS_Cisco_IOS_15_v4.1.0_Level_2.audit for Cisco IOS 15 from CIS Cisco IOS 15 Benchmark v4.1.0"
      info        : "Nessus has not identified that Cisco IOS 15 is installed.

NOTE: Nessus has not identified that the chosen audit applies to the target device."
      see_also    : "https://workbench.cisecurity.org/files/3156"
    </report>
  </else>
</if>

</check_type>
